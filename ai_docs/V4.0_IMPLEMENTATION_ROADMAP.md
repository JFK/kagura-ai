# Kagura AI v4.0 - Implementation Roadmap

**æ—¥ä»˜**: 2025-10-25 (æ›´æ–°: 2025-10-26)
**æœŸé–“**: 8-12 months (v4.0.0 â†’ v4.2.0)
**ã‚¹ã‚¿ã‚¤ãƒ«**: Agile, Issue-driven Development

---

## ğŸ“‹ Overview

ã“ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã¯ã€Kagura AIã‚’v3.0ï¼ˆPython SDK + Chatï¼‰ã‹ã‚‰**v4.0ï¼ˆUniversal AI Memory Platformï¼‰**ã¸ç§»è¡Œã™ã‚‹ãŸã‚ã®å®Ÿè£…è¨ˆç”»ã§ã™ã€‚

**Goal**:
> Make Kagura the **de facto standard** for AI Memory & Context Management across all platforms via MCP.

---

## ğŸ—“ï¸ Release Timeline

```
2025-10 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 2026-06
   â”‚                                                              â”‚
   v4.0.0a0 â”€â”€â–¶ v4.0.0 â”€â”€â”€â”€â”€â”€â”€â”€â–¶ v4.1.0 â”€â”€â”€â”€â”€â”€â”€â”€â–¶ v4.2.0
   (âœ… Oct 26)  (Q1 2026)         (Q2 2026)        (Q3-Q4 2026)

   Phase A/B     Phase C          Phase D-F        Phase G-H
   âœ… Complete   Remote MCP       Multimodal      Cloud SaaS
                 + Consolidation   MVP
```

**Legend**:
- âœ…: å®Œäº†
- é€²è¡Œä¸­: Phase Cæº–å‚™
- Phase: é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚º

---

## âœ… Phase A: MCP-First Foundation (v4.0.0a0) - COMPLETE

**æœŸé–“**: Week 1-4 (Oct 2025)
**Status**: âœ… **Complete** (Released 2025-10-26)
**Target Release**: v4.0.0a0 âœ…

### Week 1: Core Refactoring

#### Task 1.1: Repository Restructure
**Issue**: [#XXX] Refactor for Memory-First Architecture

```bash
# New structure
kagura-ai/
â”œâ”€â”€ src/kagura/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ memory/          # Memory Manager (existing)
â”‚   â”‚   â”œâ”€â”€ graph/           # GraphMemory (new, Phase B)
â”‚   â”‚   â””â”€â”€ rag/             # RAG (existing)
â”‚   â”œâ”€â”€ api/                 # ğŸ†• REST API Server
â”‚   â”‚   â”œâ”€â”€ server.py        # FastAPI app
â”‚   â”‚   â”œâ”€â”€ routes/          # API routes
â”‚   â”‚   â””â”€â”€ models.py        # Pydantic models
â”‚   â”œâ”€â”€ mcp/
â”‚   â”‚   â”œâ”€â”€ server.py        # MCP server (existing)
â”‚   â”‚   â”œâ”€â”€ tools/           # MCP tools
â”‚   â”‚   â””â”€â”€ config.py        # MCP config (from #331)
â”‚   â”œâ”€â”€ cli/
â”‚   â”‚   â”œâ”€â”€ mcp.py           # kagura mcp commands
â”‚   â”‚   â””â”€â”€ chat.py          # Minimal chat (test only)
â”‚   â””â”€â”€ tools/               # Optional tools (web, youtubeç­‰)
â”œâ”€â”€ tests/
â”œâ”€â”€ docker/                  # ğŸ†• Docker configs
â”‚   â”œâ”€â”€ docker-compose.yml   # Local deployment
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ docs/
â””â”€â”€ examples/
```

**Deliverables**:
- [ ] New directory structure
- [ ] Migration guide from v3.0
- [ ] Tests passing

**Estimate**: 3-5 days

---

#### Task 1.2: Memory API Server (FastAPI)
**Issue**: [#XXX] Implement REST API for Memory Management

**Spec**:
```python
# src/kagura/api/server.py
from fastapi import FastAPI, Depends, HTTPException
from pydantic import BaseModel

app = FastAPI(title="Kagura Memory API", version="4.0.0")

# Memory CRUD
@app.post("/api/v1/memory")
async def create_memory(...): ...

@app.get("/api/v1/memory/{key}")
async def get_memory(...): ...

@app.put("/api/v1/memory/{key}")
async def update_memory(...): ...

@app.delete("/api/v1/memory/{key}")
async def delete_memory(...): ...

# Search
@app.get("/api/v1/memory/search")
async def search_memory(...): ...

# Graph (Phase B)
@app.get("/api/v1/memory/{key}/related")
async def get_related(...): ...

@app.get("/api/v1/graph")
async def get_full_graph(): ...

# System
@app.get("/api/v1/health")
async def health_check(): ...

@app.get("/api/v1/metrics")
async def get_metrics(): ...
```

**Authentication**:
- Local: Noneï¼ˆlocalhosté™å®šï¼‰
- Self-hosted: API Keyï¼ˆPhase Cï¼‰
- Cloud: OAuth2 + JWTï¼ˆPhase Eï¼‰

**Deliverables**:
- [ ] FastAPI server implementation
- [ ] OpenAPI documentation (`/docs`)
- [ ] Testsï¼ˆunit + integrationï¼‰
- [ ] Docker support

**Estimate**: 5-7 days

---

### Week 2-3: MCP Tools v1.0

#### Task 2.1: MCP Tools Implementation
**Issue**: [#XXX] Implement MCP Tools v1.0 Contract

**Tools to Implement**:
```python
# memory.store
{
  "name": "memory_store",
  "description": "Store a memory with metadata",
  "inputSchema": {
    "type": "object",
    "properties": {
      "text": {"type": "string"},
      "kind": {"type": "string", "enum": ["note", "code", "conversation", "document"]},
      "source": {"type": "string"},
      "scope": {"type": "string", "enum": ["working", "persistent"], "default": "working"},
      "tags": {"type": "array", "items": {"type": "string"}},
      "importance": {"type": "number", "minimum": 0, "maximum": 1}
    },
    "required": ["text"]
  }
}

# memory.recall
{
  "name": "memory_recall",
  "description": "Recall memories by semantic similarity",
  "inputSchema": {
    "type": "object",
    "properties": {
      "query": {"type": "string"},
      "k": {"type": "integer", "default": 5},
      "scope": {"type": "string", "enum": ["working", "persistent", "all"], "default": "all"},
      "include_graph": {"type": "boolean", "default": false}
    },
    "required": ["query"]
  }
}

# memory.search
{
  "name": "memory_search",
  "description": "Full-text + semantic search",
  "inputSchema": {
    "type": "object",
    "properties": {
      "query": {"type": "string"},
      "filter": {"type": "object"},
      "limit": {"type": "integer", "default": 10}
    },
    "required": ["query"]
  }
}

# memory.feedback
{
  "name": "memory_feedback",
  "description": "Provide feedback on memory usefulness",
  "inputSchema": {
    "type": "object",
    "properties": {
      "node_id": {"type": "string"},
      "label": {"type": "string", "enum": ["useful", "irrelevant", "outdated"]},
      "weight": {"type": "number", "minimum": -1, "maximum": 1}
    },
    "required": ["node_id", "label"]
  }
}

# memory.delete
{
  "name": "memory_delete",
  "description": "Delete a memory (with audit log)",
  "inputSchema": {
    "type": "object",
    "properties": {
      "node_id": {"type": "string"}
    },
    "required": ["node_id"]
  }
}

# memory.export / memory.import (Phase C)
# memory.link / memory.query_graph (Phase B)
# memory.record_interaction (Phase B)
```

**Deliverables**:
- [ ] 5 core MCP tools implemented
- [ ] MCP server updated
- [ ] Tests (MCP protocol compliance)
- [ ] Documentation

**Estimate**: 7-10 days

---

#### Task 2.2: MCP Tool Management (#331 Integration)
**Issue**: [#331] MCP Enhancement - Tool Management

**Features**:
```bash
# Tool management
kagura mcp tools                    # List all tools
kagura mcp enable memory_store      # Enable specific tool
kagura mcp disable memory_search    # Disable specific tool
kagura mcp test memory_recall       # Test tool

# Diagnostics
kagura mcp doctor                   # Health check
# Output:
# âœ… MCP Server: Running
# âœ… API Server: Running (http://localhost:8080)
# âœ… Memory: 150 nodes, 87 edges
# âš ï¸  Storage: 85% full
# âŒ ChromaDB: Not initialized
#    Fix: kagura init --rag

# Claude Desktop integration
kagura mcp install                  # Auto-configure Claude Desktop
kagura mcp uninstall                # Remove configuration
```

**Deliverables**:
- [ ] CLI commands implementation
- [ ] `~/.kagura/mcp-config.yaml` support
- [ ] Claude Desktop auto-configuration
- [ ] `kagura mcp doctor` diagnostics
- [ ] Tests

**Estimate**: 5-7 days

---

### Week 4: Documentation & Alpha Release

#### Task 4.1: Documentation Rewrite
**Issue**: [#XXX] Rewrite Documentation for v4.0

**Files to Update**:
- [ ] `README.md` - New positioningï¼ˆv4.0_README_DRAFT.mdãƒ™ãƒ¼ã‚¹ï¼‰
- [ ] `docs/getting-started.md` - Quickstart guide
- [ ] `docs/api-reference.md` - REST API + MCP tools
- [ ] `docs/mcp-setup.md` - Claude Desktop integration
- [ ] `docs/architecture.md` - System architecture
- [ ] `docs/migration-v3-to-v4.md` - Migration guide

**Deliverables**:
- [ ] All docs updated
- [ ] Examples updated
- [ ] API documentation (OpenAPI)

**Estimate**: 5-7 days

---

#### Task 4.2: Alpha Release
**Issue**: [#XXX] Release v4.0.0a

**Checklist**:
- [ ] All Phase A tasks completed
- [ ] Tests passing (>90% coverage)
- [ ] Documentation complete
- [ ] Docker Compose working
- [ ] MCP tools functional
- [ ] API server functional
- [ ] Tag v4.0.0a
- [ ] PyPI releaseï¼ˆalpha channelï¼‰

**Announcement**:
- [ ] GitHub Release notes
- [ ] Blog postï¼ˆMedium/Dev.toï¼‰
- [ ] Community previewï¼ˆselect usersï¼‰

**Estimate**: 2-3 days

---

## âœ… Phase B: GraphMemory & User Pattern Analysis - COMPLETE

**æœŸé–“**: Week 5-12 (Oct 2025)
**Status**: âœ… **Complete** (Released 2025-10-26 with v4.0.0a0)
**Target Release**: v4.0.0a0 âœ…
**Issue**: [#345](https://github.com/JFK/kagura-ai/issues/345)

### Week 5-7: GraphMemory Implementation (#345)

#### Task 5.1: GraphMemory Core
**Issue**: [#345] GraphDB Integration for AI-User Relationship Memory

**Implementation**:
```python
# src/kagura/core/graph/memory.py
import networkx as nx
from typing import Optional

class GraphMemory:
    """NetworkX-based graph memory for relationships"""

    def __init__(self, persist_path: Optional[str] = None):
        self.graph = nx.DiGraph()
        self.persist_path = persist_path

    # Node types
    NODE_TYPES = ["user", "topic", "memory", "interaction"]

    # Edge types
    EDGE_TYPES = [
        "related_to",
        "depends_on",
        "learned_from",
        "influences",
        "works_on"
    ]

    async def add_node(self, node_id: str, node_type: str, data: dict):
        """Add node to graph"""
        self.graph.add_node(node_id, type=node_type, **data)

    async def add_edge(
        self,
        src_id: str,
        dst_id: str,
        rel_type: str,
        weight: float = 1.0
    ):
        """Add edge between nodes"""
        self.graph.add_edge(src_id, dst_id, type=rel_type, weight=weight)

    async def query_graph(
        self,
        seed_ids: list[str],
        hops: int = 2,
        rel_filters: Optional[list[str]] = None
    ) -> dict:
        """Multi-hop graph traversal"""
        subgraph = self._traverse(seed_ids, hops, rel_filters)
        return self._serialize_subgraph(subgraph)

    async def get_related(
        self,
        node_id: str,
        depth: int = 2
    ) -> list[dict]:
        """Get related nodes by traversal"""
        ...

    async def record_interaction(
        self,
        user_id: str,
        ai_platform: str,
        query: str,
        response: str,
        meta: dict
    ):
        """Record AI-User interaction"""
        interaction_id = f"int_{timestamp}_{uuid}"
        await self.add_node(interaction_id, "interaction", {
            "user_id": user_id,
            "ai_platform": ai_platform,
            "query": query,
            "response": response,
            "timestamp": meta["timestamp"],
            **meta
        })
        # Link to user, topics, memories
        ...

    async def persist(self):
        """Save graph to disk (pickle)"""
        import pickle
        with open(self.persist_path, "wb") as f:
            pickle.dump(self.graph, f)

    async def load(self):
        """Load graph from disk"""
        import pickle
        with open(self.persist_path, "rb") as f:
            self.graph = pickle.load(f)
```

**Deliverables**:
- [ ] GraphMemory class
- [ ] Node/Edge management
- [ ] Graph traversal
- [ ] Persistence (pickle)
- [ ] Tests

**Estimate**: 10-12 days

---

#### Task 5.2: MemoryManager Integration
**Issue**: [#XXX] Integrate GraphMemory into MemoryManager

```python
# src/kagura/core/memory/manager.py
from kagura.core.graph.memory import GraphMemory

class MemoryManager:
    def __init__(self, ..., enable_graph: bool = True):
        self.working = WorkingMemory()
        self.context = ContextMemory()
        self.persistent = PersistentMemory()
        self.rag = MemoryRAG()
        self.persistent_rag = MemoryRAG()  # #340
        self.graph = GraphMemory() if enable_graph else None  # ğŸ†•

    async def store(self, key: str, value: str, scope: str = "working"):
        # Existing logic
        ...

        # Add to graph
        if self.graph:
            await self.graph.add_node(
                node_id=f"{scope}:{key}",
                node_type="memory",
                data={"key": key, "value": value, "scope": scope}
            )
```

**Deliverables**:
- [ ] GraphMemory integration
- [ ] Backward compatibilityï¼ˆ`enable_graph=False`ï¼‰
- [ ] Tests

**Estimate**: 3-5 days

---

#### Task 5.3: MCP Tools for Graph
**Issue**: [#XXX] Add Graph Operations to MCP Tools

```python
# memory.link
{
  "name": "memory_link",
  "description": "Create relationship between memories",
  "inputSchema": {
    "type": "object",
    "properties": {
      "src_id": {"type": "string"},
      "dst_id": {"type": "string"},
      "rel_type": {"type": "string", "enum": ["related_to", "depends_on", ...]},
      "weight": {"type": "number", "default": 1.0}
    },
    "required": ["src_id", "dst_id", "rel_type"]
  }
}

# memory.query_graph
{
  "name": "memory_query_graph",
  "description": "Multi-hop graph traversal",
  "inputSchema": {
    "type": "object",
    "properties": {
      "seed_ids": {"type": "array", "items": {"type": "string"}},
      "hops": {"type": "integer", "default": 2},
      "rel_filters": {"type": "array", "items": {"type": "string"}}
    },
    "required": ["seed_ids"]
  }
}

# memory.record_interaction
{
  "name": "memory_record_interaction",
  "description": "Record AI-User interaction for Vibe Coding history",
  "inputSchema": {
    "type": "object",
    "properties": {
      "ai_platform": {"type": "string"},
      "query": {"type": "string"},
      "response": {"type": "string"},
      "meta": {"type": "object"}
    },
    "required": ["ai_platform", "query", "response"]
  }
}
```

**Deliverables**:
- [ ] 3 new MCP tools
- [ ] Tests
- [ ] Documentation

**Estimate**: 5-7 days

---

### Week 8-10: Consolidation & Export

#### Task 8.1: Memory Consolidation
**Issue**: [#XXX] Implement Memory Consolidation (Short â†’ Long-term)

**Features**:
- Short-term â†’ Long-term migration
- Summarizationï¼ˆé‡è¤‡æƒ…å ±ã®çµ±åˆï¼‰
- Importance scoringï¼ˆHebbian-likeï¼‰
- Deduplication

**Implementation**:
```python
# src/kagura/core/memory/consolidation.py
from kagura.core.memory import MemoryManager

class MemoryConsolidator:
    async def consolidate(
        self,
        manager: MemoryManager,
        strategy: str = "auto"
    ):
        """Consolidate memories from working to persistent"""
        # 1. Identify candidates (age, importance)
        candidates = await self._identify_candidates(manager.working)

        # 2. Summarize duplicates
        consolidated = await self._summarize_duplicates(candidates)

        # 3. Update importance scores
        scored = await self._update_importance(consolidated)

        # 4. Migrate to persistent
        for memory in scored:
            await manager.persistent.store(memory.key, memory.value)
            await manager.working.delete(memory.key)

        # 5. Update graph weights
        if manager.graph:
            await manager.graph.update_weights()
```

**Deliverables**:
- [ ] Consolidation logic
- [ ] CLI command: `kagura memory consolidate`
- [ ] Scheduled job supportï¼ˆcron/systemdï¼‰
- [ ] Tests

**Estimate**: 7-10 days

---

#### Task 8.2: Export/Import
**Issue**: [#XXX] Implement Complete Data Export/Import

**Format (JSONL)**:
```jsonl
{"type": "memory", "id": "mem_001", "key": "...", "value": "...", "scope": "persistent", "tags": ["python"], "created_at": "2025-10-25T12:00:00Z"}
{"type": "edge", "src": "mem_001", "dst": "mem_002", "rel_type": "related_to", "weight": 0.8}
{"type": "interaction", "id": "int_001", "user_id": "user_1", "ai_platform": "claude", "query": "...", "response": "...", "timestamp": "..."}
```

**Attachments**:
```
export/
â”œâ”€â”€ memories.jsonl
â”œâ”€â”€ graph.jsonl
â”œâ”€â”€ interactions.jsonl
â””â”€â”€ attachments/
    â”œâ”€â”€ file_001.pdf
    â””â”€â”€ image_002.png
```

**Implementation**:
```python
# src/kagura/core/memory/export.py
async def export_all(output_dir: str):
    """Export all memories, graph, interactions"""
    ...

async def import_all(input_dir: str):
    """Import from exported data"""
    ...
```

**Deliverables**:
- [ ] Export logic
- [ ] Import logic
- [ ] CLI commands: `kagura memory export/import`
- [ ] Testsï¼ˆroundtripï¼‰

**Estimate**: 5-7 days

---

### Week 11-12: Testing & Stable Release

#### Task 11.1: Integration Testing
**Issue**: [#XXX] Comprehensive Integration Tests for v4.0

**Test Scenarios**:
- [ ] MCP client â†’ MCP server â†’ API â†’ Storage
- [ ] Memory CRUD via MCP
- [ ] Graph operations via MCP
- [ ] Consolidation process
- [ ] Export/Import roundtrip
- [ ] Multiple clients concurrently

**Deliverables**:
- [ ] Integration test suite
- [ ] Performance benchmarks
- [ ] Load testing

**Estimate**: 5-7 days

---

#### Task 11.2: v4.0.0 Stable Release
**Issue**: [#XXX] Release v4.0.0 (Stable)

**Checklist**:
- [ ] All Phase B tasks completed
- [ ] Tests passing (>90% coverage)
- [ ] Documentation updated
- [ ] Performance benchmarks published
- [ ] Migration guide finalized
- [ ] Tag v4.0.0
- [ ] PyPI releaseï¼ˆstableï¼‰

**Launch**:
- [ ] GitHub Release
- [ ] Hacker News - "Show HN: Kagura - Universal Memory Layer for AI (MCP-native)"
- [ ] Reddit postsï¼ˆr/LLMs, r/ClaudeAIï¼‰
- [ ] Blog postï¼ˆannouncementï¼‰
- [ ] Product Huntï¼ˆoptionalï¼‰

**Estimate**: 3-5 days

---

## ğŸš€ Phase C: Remote MCP Server + Consolidation (v4.0.0 stable)

**æœŸé–“**: Late Nov 2025 - Q1 2026 (4 weeks)
**Status**: ğŸ”„ **æº–å‚™ä¸­** (Cleanup: Issues #373-376)
**Target Release**: v4.0.0 stable
**Issue**: [#378](https://github.com/JFK/kagura-ai/issues/378)

**Goal**:
1. **Remote MCP Server** (#368) - Network-accessible MCP tools
2. **Memory Consolidation** - Export/Import, lifecycle management

---

### Overview

Phase Cã§ã¯ã€v4.0.0a0ã‚’å®‰å®šç‰ˆv4.0.0ã«ã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã‚’å®Ÿè£…ï¼š

**1. Remote MCP Server** (Issue #368):
- Approach: **Option 2 (Hybrid)** - Local MCP Connector + Remote REST API
- Local connector: stdio â†” HTTP bridge
- API authentication: API Key
- Tool access control: local-only filtering
- Production Docker setup

**2. Memory Consolidation**:
- Short-term â†’ Long-term migration
- Export/Import (JSONL format)
- Summarization & deduplication
- GDPR-compliant deletion

---

### Implementation Tasks

è©³ç´°ã¯ Issue #378 ã‚’å‚ç…§

**Week 1-2**: Remote MCP Server
- MCP Connector implementation
- API Key authentication
- Tool access control
- CLI commands (\`kagura mcp connect\`, \`kagura mcp serve --remote\`)

**Week 3**: Memory Consolidation
- Lifecycle management
- Export/Import (JSONL)
- Deletion audit logs

**Week 4**: Testing & Documentation
- Integration testing
- Docker production setup
- Documentation
- v4.0.0 stable release

---

## ğŸŒ Phase D-F: Self-hosted API + Multimodal MVP + Consumer App (v4.1.0)

**æœŸé–“**: Q2 2026 (3 months)
**Goal**: Self-hosted APIã€Connectorså®Ÿè£…
**Target Release**: v4.1.0

### Week 13-15: Self-hosted API

#### Task 13.1: Authentication & Authorization
**Issue**: [#XXX] Implement API Authentication

**Features**:
- API Key management
- OAuth2 supportï¼ˆoptionalï¼‰
- Rate limiting
- CORS configuration

**Implementation**:
```python
# src/kagura/api/auth.py
from fastapi import Depends, HTTPException
from fastapi.security import APIKeyHeader

api_key_header = APIKeyHeader(name="X-API-Key")

async def verify_api_key(api_key: str = Depends(api_key_header)):
    if not validate_api_key(api_key):
        raise HTTPException(status_code=403, detail="Invalid API key")
    return api_key
```

**Deliverables**:
- [ ] API Key management
- [ ] CLI: `kagura api-key create/list/revoke`
- [ ] Rate limiting
- [ ] Tests

**Estimate**: 5-7 days

---

#### Task 13.2: Production Deployment
**Issue**: [#XXX] Production-ready Docker Compose

**Features**:
- PostgreSQL + pgvector
- Redisï¼ˆjob queueï¼‰
- Nginxï¼ˆreverse proxyï¼‰
- Let's Encrypt SSL
- Monitoringï¼ˆPrometheus/Grafanaï¼‰

**docker-compose.prod.yml**:
```yaml
services:
  postgres:
    image: pgvector/pgvector:pg16
    environment:
      POSTGRES_DB: kagura
      POSTGRES_USER: kagura
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data

  api:
    build: .
    environment:
      DATABASE_URL: postgres://kagura:${DB_PASSWORD}@postgres/kagura
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis

  nginx:
    image: nginx:alpine
    ports:
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/ssl
```

**Deliverables**:
- [ ] Production Docker Compose
- [ ] Deployment guide
- [ ] Backup/Restore scripts
- [ ] Monitoring dashboard

**Estimate**: 7-10 days

---

### Week 16-18: Connectors

#### Task 16.1: GitHub Connector
**Issue**: [#XXX] GitHub Connector for Codebase Indexing

**Features**:
- Repository indexing
- Commit history tracking
- PR/Issue indexing
- Selective syncï¼ˆbranches, date rangeï¼‰

**Implementation**:
```python
# src/kagura/connectors/github.py
from github import Github

class GitHubConnector:
    async def index_repository(
        self,
        repo_url: str,
        branches: list[str] = ["main"],
        since: Optional[datetime] = None
    ):
        """Index GitHub repository"""
        # 1. Clone or fetch
        # 2. Extract code, commits, PRs
        # 3. Store in memory + RAG
        # 4. Build graphï¼ˆfiles â†’ dependenciesï¼‰
        ...
```

**Deliverables**:
- [ ] GitHub connector
- [ ] CLI: `kagura connect github <repo_url>`
- [ ] Selective sync settings
- [ ] Tests

**Estimate**: 7-10 days

---

#### Task 16.2: Calendar & Files Connectors
**Issue**: [#XXX] Calendar & Files Connectors

**Calendar**:
- Google Calendar API
- Event indexing
- Meeting notes association

**Files**:
- Local file indexing
- Watch modeï¼ˆinotifyï¼‰
- Supported formats: .txt, .md, .pdf, .docx

**Deliverables**:
- [ ] Calendar connector
- [ ] Files connector
- [ ] CLI commands
- [ ] Tests

**Estimate**: 5-7 days

---

### Week 19-20: v4.1.0 Release

#### Task 19.1: Testing & Documentation
**Issue**: [#XXX] v4.1 Testing & Documentation

**Testing**:
- [ ] Self-hosted deployment tests
- [ ] Multi-user tests
- [ ] Connector tests

**Documentation**:
- [ ] Self-hosted deployment guide
- [ ] Connector setup guides
- [ ] API authentication guide

**Estimate**: 5-7 days

---

#### Task 19.2: v4.1.0 Release
**Issue**: [#XXX] Release v4.1.0

**Launch**:
- [ ] GitHub Release
- [ ] Blog postï¼ˆself-hosted focusï¼‰
- [ ] Community showcaseï¼ˆãƒ‡ãƒ¢å‹•ç”»ï¼‰

**Estimate**: 2-3 days

---

## ğŸ“± Phase D: Consumer App (v4.1.x)

**æœŸé–“**: Week 13-24 (3 months, parallel with Phase C)
**Goal**: Flutter appé–‹ç™ºãƒ»å…¬é–‹
**Target Release**: v4.1.5

### Week 13-16: Flutter App Development

#### Task 13.1: App Architecture
**Issue**: [#XXX] Flutter App Architecture

**Structure**:
```
kagura-app/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ main.dart
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ memory.dart
â”‚   â”‚   â”œâ”€â”€ graph_node.dart
â”‚   â”‚   â””â”€â”€ insight.dart
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ api_client.dart       # Kagura API client
â”‚   â”‚   â””â”€â”€ auth_service.dart     # Authentication
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”œâ”€â”€ memory_provider.dart  # State management (Riverpod)
â”‚   â”‚   â””â”€â”€ graph_provider.dart
â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”œâ”€â”€ home_screen.dart
â”‚   â”‚   â”œâ”€â”€ memory_browser.dart
â”‚   â”‚   â”œâ”€â”€ graph_viewer.dart
â”‚   â”‚   â”œâ”€â”€ search_screen.dart
â”‚   â”‚   â””â”€â”€ settings_screen.dart
â”‚   â””â”€â”€ widgets/
â”‚       â”œâ”€â”€ memory_card.dart
â”‚       â””â”€â”€ graph_widget.dart
â”œâ”€â”€ test/
â”œâ”€â”€ ios/
â”œâ”€â”€ android/
â”œâ”€â”€ macos/
â”œâ”€â”€ windows/
â””â”€â”€ linux/
```

**Deliverables**:
- [ ] App architecture design
- [ ] Navigation structure
- [ ] State management setup

**Estimate**: 3-5 days

---

#### Task 14.1: Core Features Implementation
**Issue**: [#XXX] Implement Core App Features

**Features**:
- [ ] Memory Browserï¼ˆã‚«ãƒ¼ãƒ‰å½¢å¼ï¼‰
- [ ] Searchï¼ˆãƒ•ãƒ«ãƒ†ã‚­ã‚¹ãƒˆ + ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ï¼‰
- [ ] Memory detail view
- [ ] Manual add/edit/delete
- [ ] Tags management
- [ ] Settingsï¼ˆAPI endpoint, themeï¼‰

**Deliverables**:
- [ ] Core screens implementation
- [ ] API integration
- [ ] Tests

**Estimate**: 15-20 days

---

#### Task 15.1: Graph Viewer
**Issue**: [#XXX] Implement Graph Visualization

**Library**: flutter_force_directed_graph or custom D3.js wrapper

**Features**:
- [ ] Interactive graph view
- [ ] Node filteringï¼ˆby type, tagï¼‰
- [ ] Edge highlighting
- [ ] Node details on tap
- [ ] Zoom/Pan

**Deliverables**:
- [ ] Graph viewer screen
- [ ] Graph rendering logic
- [ ] Tests

**Estimate**: 7-10 days

---

### Week 17-20: Insights & Polish

#### Task 17.1: Insights Dashboard
**Issue**: [#XXX] Implement Insights & Analytics

**Features**:
- [ ] Memory statisticsï¼ˆtotal, by scope, by tagï¼‰
- [ ] Interaction historyï¼ˆAI platforms used, frequencyï¼‰
- [ ] Learning patternsï¼ˆtopics over timeï¼‰
- [ ] Vibe Coding insightsï¼ˆcoding sessions, patternsï¼‰

**Deliverables**:
- [ ] Insights screen
- [ ] Chartsï¼ˆfl_chart libraryï¼‰
- [ ] Tests

**Estimate**: 7-10 days

---

#### Task 18.1: UI/UX Polish
**Issue**: [#XXX] UI/UX Polish & Testing

**Tasks**:
- [ ] UI refinementï¼ˆMaterial Design 3ï¼‰
- [ ] Dark mode
- [ ] Animations
- [ ] Accessibility
- [ ] Localizationï¼ˆè‹±èªãƒ»æ—¥æœ¬èªï¼‰

**Deliverables**:
- [ ] Polished UI
- [ ] Accessibility compliance
- [ ] Localization files

**Estimate**: 7-10 days

---

### Week 21-24: App Release

#### Task 21.1: Platform Builds
**Issue**: [#XXX] Build for All Platforms

**Platforms**:
- [ ] iOSï¼ˆApp Storeï¼‰
- [ ] Androidï¼ˆGoogle Playï¼‰
- [ ] macOSï¼ˆApp Store / Direct downloadï¼‰
- [ ] Windowsï¼ˆMicrosoft Store / Direct downloadï¼‰
- [ ] Linuxï¼ˆSnap / AppImageï¼‰

**Deliverables**:
- [ ] Platform-specific builds
- [ ] Signing certificates
- [ ] Store listings

**Estimate**: 5-7 days

---

#### Task 22.1: App Store Submission
**Issue**: [#XXX] Submit to App Stores

**Tasks**:
- [ ] iOS App Store submission
- [ ] Google Play submission
- [ ] Screenshots, descriptions
- [ ] Privacy policy
- [ ] Terms of service

**Deliverables**:
- [ ] Published apps
- [ ] App Store Optimization

**Estimate**: 5-7 daysï¼ˆincluding review timeï¼‰

---

#### Task 23.1: Launch Campaign
**Issue**: [#XXX] App Launch Campaign

**Channels**:
- [ ] Product Hunt launch
- [ ] Blog postï¼ˆapp focusï¼‰
- [ ] Twitter/X announcement
- [ ] YouTube demo video
- [ ] Reddit posts

**Deliverables**:
- [ ] Marketing materials
- [ ] Launch posts
- [ ] Demo video

**Estimate**: 3-5 days

---

## â˜ï¸ Phase E: Cloud & Enterprise (v4.2.0)

**æœŸé–“**: Week 25-48 (6 months)
**Goal**: Cloud SaaSã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½
**Target Release**: v4.2.0

### Weeks 25-48: Cloud Infrastructure & Enterprise Features

#### Major Tasks
- [ ] Multi-tenant architecture
- [ ] Row-Level Security (RLS)
- [ ] BYOK (Bring Your Own Key)
- [ ] SSO (SAML, OIDC)
- [ ] Audit logs
- [ ] Team collaboration
- [ ] Billing system
- [ ] Admin dashboard
- [ ] Complianceï¼ˆGDPR, SOC2ï¼‰

**Note**: è©³ç´°ã¯åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ`V4.2_CLOUD_ROADMAP.md`ã‚’å‚ç…§

---

## ğŸ“¦ æä¾›ã•ã‚Œã‚‹å®Ÿè£…ãƒ”ãƒ¼ã‚¹ï¼ˆChatGPT 5 Proï¼‰

### åˆ©ç”¨å¯èƒ½ãªzipãƒ•ã‚¡ã‚¤ãƒ«

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å…ƒã«æŒã£ã¦ã„ã‚‹å®Ÿè£…ã‚³ãƒ¼ãƒ‰ï¼š

1. **nmn_poc_v02.zip**
   - Memory API v0.2ï¼ˆpgvector + Redis/RQ + FastAPI + OpenAPIï¼‰
   - å³åº§ã«ä½¿ãˆã‚‹å®Ÿè£…

2. **nmn_poc_v01.zip**
   - æœ€å°ç‰ˆ v0.1ï¼ˆã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªï¼‰
   - ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—

3. **nmn_mcp_tools.zip**
   - MCPãƒ„ãƒ¼ãƒ«ã‚µãƒ¼ãƒï¼ˆæœ€å° / RESTãƒ—ãƒ­ã‚­ã‚·ï¼‰
   - recall/feedback/forget å®Ÿè£…æ¸ˆã¿

4. **nmn_bench.zip**
   - ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¹ã‚¤ãƒ¼ãƒˆï¼ˆpgvector / FAISS vs NumPyï¼‰

### æ´»ç”¨æ–¹æ³•

#### Phase A (Week 1-2): API Server
```bash
# nmn_poc_v02.zip ã‚’è§£å‡
unzip nmn_poc_v02.zip -d /tmp/nmn_poc
cd /tmp/nmn_poc

# Kaguraãƒªãƒã‚¸ãƒˆãƒªã«ãƒãƒ¼ã‚¸
cp -r nmn_poc/api/* /home/jfk/works/kagura-ai/src/kagura/api/

# Adapt to Kagura structure
# - Rename modules
# - Update imports
# - Integrate with MemoryManager
```

#### Phase A (Week 2-3): MCP Tools
```bash
# nmn_mcp_tools.zip ã‚’è§£å‡
unzip nmn_mcp_tools.zip -d /tmp/nmn_mcp
cd /tmp/nmn_mcp

# Add to Kagura MCP server
cp nmn_mcp/tools/* /home/jfk/works/kagura-ai/src/kagura/mcp/tools/

# Extend with memory.store, memory.search
```

#### Phase B (Week 5-7): Benchmarks
```bash
# nmn_bench.zip ã‚’è§£å‡
unzip nmn_bench.zip -d /tmp/nmn_bench

# Use for performance testing
python nmn_bench/benchmark.py --vector-db=chromadb --n-nodes=10000
```

---

## ğŸ“Š KPIs & Success Metrics

### Technical Metrics

| Metric | v4.0 Target | v4.1 Target | v4.2 Target |
|--------|-------------|-------------|-------------|
| **Setup Time** | 10 min | 5 min | 1 min (Cloud) |
| **Recall@5** | 0.85+ | 0.90+ | 0.95+ |
| **p95 Latency** | < 100ms | < 50ms | < 30ms |
| **Export Success** | 99%+ | 99.9%+ | 99.99%+ |
| **Test Coverage** | 90%+ | 92%+ | 95%+ |

### User Metrics

| Metric | v4.0 Target | v4.1 Target | v4.2 Target |
|--------|-------------|-------------|-------------|
| **MAU** | 500 | 5,000 | 50,000 |
| **GitHub Stars** | 1,000 | 5,000 | 10,000+ |
| **App Downloads** | - | 10,000 | 100,000 |
| **NPS** | 40+ | 50+ | 60+ |

### Business Metrics (v4.1+)

| Metric | v4.1 Target | v4.2 Target |
|--------|-------------|-------------|
| **Paying Users** | 100 | 1,000 |
| **MRR** | $1,000 | $10,000 |
| **Churn Rate** | < 10% | < 5% |
| **CAC** | < $50 | < $30 |

---

## ğŸ”— Related Documents

- [V4.0_STRATEGIC_PIVOT.md](./V4.0_STRATEGIC_PIVOT.md) - æˆ¦ç•¥æ¦‚è¦
- [V4.0_COMPETITIVE_ANALYSIS.md](./V4.0_COMPETITIVE_ANALYSIS.md) - ç«¶åˆåˆ†æ
- [V4.0_README_DRAFT.md](./V4.0_README_DRAFT.md) - æ–°READMEè‰æ¡ˆ
- [V4.0_GITHUB_ISSUE_TEMPLATE.md](./V4.0_GITHUB_ISSUE_TEMPLATE.md) - Issueä½œæˆç”¨

**æ—¢å­˜Issueå‚ç…§**:
- [#331: MCP Enhancement Roadmap](https://github.com/JFK/kagura-ai/issues/331)
- [#345: GraphDB Memory Integration](https://github.com/JFK/kagura-ai/issues/345)

---

## ğŸ“ Update History

| Date | Update | Phase | Author |
|------|--------|-------|--------|
| 2025-10-25 | Initial roadmap | All | Claude Code |

---

**Status**: ğŸ“‹ Draft (Awaiting Community Feedback)
**Owner**: @jfk
**Next Review**: Weekly during active development
