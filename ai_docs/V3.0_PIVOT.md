# Kagura AI v3.0 Pivot: Personal Assistant SDK

**日付**: 2025-10-18  
**決定**: v3.0方針転換 - Framework → Personal Assistant SDK

---

## 🔄 なぜピボットするのか

### v2.x の課題
- **フレームワーク的**: 開発者向けが強い
- **エンドユーザー体験不足**: Chatはあるが、使いにくい
- **Personal Toolsの立ち位置不明**: AgentなのかToolなのか

### v3.0の解決策
- **SDK化**: `from kagura import daily_news` で即座に使える
- **Chat-First**: `kagura chat` が最高のUX
- **Personal Tools = Built-in**: フレームワークの一部として提供

---

## 📐 v3.0アーキテクチャ

### 3層構造

```
┌─────────────────────────────────────┐
│  Layer 1: Chat Interface            │
│  - kagura chat (Claude Code-like)   │
│  - kagura init (Personalization)    │
└─────────────────────────────────────┘
           ↓ uses
┌─────────────────────────────────────┐
│  Layer 2: Personal Tools (Built-in) │
│  - daily_news, weather_forecast     │
│  - search_recipes, find_events      │
│  - (SDK exportで直接使用可能)      │
└─────────────────────────────────────┘
           ↓ uses
┌─────────────────────────────────────┐
│  Layer 3: Core Framework            │
│  - @agent, @tool, @workflow         │
│  - LLM integration, Memory, etc.    │
└─────────────────────────────────────┘
```

---

## 🎯 Personal Tools設計決定

### 現状 (v3.0-beta)
```python
# src/kagura/agents/news.py
@agent(model="gpt-5-nano", tools=[brave_web_search], stream=True)
async def daily_news(query: str) -> str:
    ...
```

**問題**:
- `agents/` ディレクトリ = サンプル的
- SDK exportが不明確
- Built-in Toolsとの関係が曖昧

### v3.0決定: **Personal Tools = Built-in**

**Option 1: agents/ → builtin/personal.py に移動** (推奨)
```python
# src/kagura/builtin/personal.py
@agent(model="gpt-5-nano", tools=[brave_web_search], stream=True)
async def daily_news(query: str) -> str:
    ...

# src/kagura/__init__.py
from .builtin.personal import daily_news, weather_forecast, ...
```

**Option 2: 現状維持 + Export明確化**
```python
# src/kagura/agents/ はそのまま
# src/kagura/__init__.py
from .agents import daily_news, weather_forecast, ...

__all__ = ["agent", "daily_news", ...]  # 明示的にエクスポート
```

**決定**: **Option 2** (シンプル、既存コード変更最小)

---

## 📦 SDK Exports方針

### src/kagura/__init__.py (拡張版)

```python
"""Kagura AI - Personal AI Assistant SDK"""

# Core decorators
from .core.decorators import agent, tool, workflow

# Personal Tools (Built-in)
from .agents import (
    daily_news,        # 📰 News briefing
    weather_forecast,  # 🌤️ Weather updates
    search_recipes,    # 🍳 Recipe search
    find_events,       # 🎉 Event finder
)

# Chat Interface
from .chat import ChatSession

# Config
from .config import UserConfig, get_user_config

# Built-in Tools (useful for SDK users)
from .tools import (
    brave_web_search,
    get_youtube_transcript,
    get_youtube_metadata,
)

__all__ = [
    # Core
    "agent", "tool", "workflow",
    # Personal Tools
    "daily_news", "weather_forecast", "search_recipes", "find_events",
    # Chat
    "ChatSession",
    # Config
    "UserConfig", "get_user_config",
    # Tools
    "brave_web_search", "get_youtube_transcript", "get_youtube_metadata",
]
```

### 使用例

**SDK的使用**:
```python
from kagura import daily_news, weather_forecast

# 直接呼び出し
news = await daily_news("tech")
weather = await weather_forecast("Tokyo weather")
```

**Chat使用**:
```bash
$ kagura init  # 初回セットアップ
$ kagura chat  # Chat起動
> 天気は？  # Personal Toolsが自動検出
```

---

## 🧹 Issue整理方針

### クローズ対象 (v3.0スコープ外)

**エンタープライズ機能** (個人利用フォーカスのため):
- #155 - Google Workspace Integration
- #86 - Agent API Server (v4.0へ)
- #68 - Plugin Marketplace (v3.5へ)
- #69 - Multi-Agent Orchestration (v4.0へ)

**重複・低優先度**:
- #70 - Observability Extended (duplicate)
- #227 - Codebase Redundancy (後回し)
- #149 - Workflow helpers (後回し)

### 残す (v3.0重要)

**ドキュメント** (Critical):
- #297 - Docs rewrite (v3.0対応)
- #276, #264, #265 - Docs整備

**機能改善** (High):
- #288 - Meta test fix (簡単)
- #221 - Auto-Discovery (v3.1候補)
- #241 - Pre-installed Agents (v3.1候補)

---

## 📝 v3.0完成チェックリスト

### 機能 (完了)
- ✅ Streaming support
- ✅ User config (kagura init)
- ✅ Personal Tools (4個)
- ✅ Progress visibility

### ドキュメント (未完)
- ⏳ README.md書き換え
- ⏳ Examples更新
- ⏳ API docs更新

### SDK化 (未完)
- ⏳ __init__.py exports拡張
- ⏳ Personal Tools直接import可能
- ⏳ Quickstart例

### リリース準備 (未完)
- ⏳ CHANGELOG.md
- ⏳ バージョン更新
- ⏳ PyPI release

---

## 🎯 v3.0成功基準

**エンドユーザー**:
1. `kagura init` → `kagura chat` で即座に使える
2. Personal Toolsが自然言語で使える
3. ストリーミング表示でストレスフリー

**開発者**:
1. `from kagura import daily_news` で即座に使える
2. 3行でエージェント作成可能
3. ドキュメントが明確

**両方達成 = v3.0成功**

---

**次のアクション**: ドキュメント刷新 → SDK化 → Issue整理 → v3.0.0リリース

